# Sub-GHz

**Задача**: проверить радиотракт на прием и передачу

## Подготовка

* Прошивка для тестирования CC1101
* Анализатор спектра или осциллограф.
* SDR-приемник.
* Клетка Фарадея, оборудованная
	* заранее определенным местом для установки целевого устройства и референсного устройства
	* приемной антенной с фиксированным местоположением для подключения измерительного оборудования
* Референсное устройство Flipper (заранее проверенное с точки зрения радио интерфейса)

Поддерживаемые диапазоны частот

* 300-348 MHz
* 387-464 MHz
* 779-928 MHz

Список частот для тестов выбирается как значения на границах диапазонов.

## TX Testing

1. Целевое устройство помещается в клетку Фарадея
2. Целевое устройство излучает несущую на заданной частоте
3. Провести измерения спектральной маски
4. Сравнить измеренные значения с требуемыми **TODO**

Тест на передачу позволяет проверить корректность работы радиотракта.

## TX-RX Testing (интеграционный тест)

Тест проводится с использованием двух устройств, одно из которых является референсным, с заранее проверенной RF частью

1. Референсное и целевое устройство помещается в клетку Фарадея
2. Запускается радиообмен между тестируемым и референсным устройствами, передача 10000 (TBD) пакетов
	* Целевое передает, референсное принимает
	* Референсное передает, целевое принимает
3. По результатам теста количество потерянных пакетов должно быть не более 0.1% **TBD** в каждом случае.

# Firmware

Прошивка для тестирования реализует следующие функции (в порядке уровней абстракции)

* Инициализация SPI
* Обмен данными с чипом CC1101, инициализация радиоинтерфейса
* Режим передачи несущей на заданной частоте.
* Режим передачи на заданной частоте 10k пакетов с псевдослучаными данными, содержащих в конце каждого контрольную сумму для проверки правильности приема
* Режим приема пакетов c расчетом контрольной суммы и счетчиком количества верно принятых пакетов

При возникновении ошибок - прошивка сообщает об этом, для упрощения отладки.

